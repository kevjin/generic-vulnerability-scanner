from framework.resources.types import ResourceType

def validate(file, languages_and_libraries, debug = False):
    if ResourceType.PYTHON_REQUESTS not in languages_and_libraries:
        return True

    if debug:
        print("[PYTHON_REQUESTS]: Checking for SSL vulnerability...")

    file_name, file_contents = file
    for line_number, line in enumerate(file_contents):
        if "verify=False" in line:
            error = "[PYTHON_REQUESTS]: SSL Verification Vulnerability in file: %s, line: %d." % (file_name, line_number)
            print(error)
            return False

    if debug:
        print("[PYTHON_REQUESTS]: Successfully found valid SSL verification.")
    return True