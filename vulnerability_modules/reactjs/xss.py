from vulnerability_tool.framework.resources.types import ResourceType

def validate(file, languages_and_libraries, debug = False):
    if ResourceType.REACT_JS not in languages_and_libraries:
        return True # quit

    if debug:
        print("[REACT_JS]: Checking for XSS vulnerability...")

    file_name, file_contents = file
    for line_number, line in enumerate(file_contents):
        if "dangerouslySetInnerHTML" in line:
            error = "[REACT_JS]: XSS Vulnerability in file: %s, line: %d." % (file_name, line_number + 1)
            print(error)
            return False

    if debug:
        print("[REACT_JS]: Successfully found no React XSS injections.")
    return True