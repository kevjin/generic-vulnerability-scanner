from framework.resources.types import ResourceType

def validate(file, languages_and_libraries, debug = False):
    if ResourceType.REACT_JS not in languages_and_libraries: # TODO: make array of enums
        return # quit

    if debug:
        print("[DEBUG]: Checking for XSS vulnerability.")

    file_name, file_contents = file
    for line_number, line in enumerate(file_contents):
        if "dangerouslySetInnerHTML" in line:
            error = "XSS Vulnerability in file: %s, line: %d." % (file_name, line_number)
            print(error)
            return False

    if debug:
        print("[DEBUG]: Successfully checked for React XSS injection.")
    return True

def module():
    print("lmaofffddddddffttt00000o")